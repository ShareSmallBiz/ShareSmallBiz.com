@{
    ViewData["Title"] = "Forum Home";
}

<div class="container mt-4">
    <h2 class="text-center mb-4">
        <i class="bi bi-chat-dots-fill"></i> Discussions
    </h2>

    <!-- Full-width Navigation Bar -->
    <div class="d-flex justify-content-center mb-4">
        <div class="btn-group" role="group">
            <!-- Most Popular Button -->
            <button class="btn btn-outline-primary" onclick="loadPosts('/Forum/Home/popular/10')">
                <i class="bi bi-trophy-fill me-2"></i> Most Popular
            </button>

            <!-- Most Comments Button -->
            <button class="btn btn-outline-warning" onclick="loadPosts('/Forum/Home/commented/10')">
                <i class="bi bi-chat-left-dots-fill me-2"></i> Most Comments
            </button>

            <!-- Recent Posts Button -->
            <button class="btn btn-outline-success" onclick="loadPosts('/Forum/Home/recent/10')">
                <i class="bi bi-clock-fill me-2"></i> Recent Posts
            </button>
        </div>
    </div>

    <!-- Posts Container -->
    <div id="postsContainer" class="list-group"></div>

    <!-- Pagination Section -->
    <div id="pagination" class="mt-3"></div>
</div>



@section Scripts {
    <script>
        $(document).ready(function () {
            loadPosts('/Forum/Home/recent/10');
        });

        function loadPosts(endpoint) {
            $.get(endpoint, function (data) {
                $("#postsContainer").html(data);
                $("#pagination").html("");
            });
        }

        function loadPagedPosts(pageNumber) {
            $.get(`/Forum/Home/paged?pageNumber=${pageNumber}&pageSize=10`, function (data) {
                $("#postsContainer").html(data.html);
                setupPagination(data.totalPages, pageNumber);
            });
        }

        function setupPagination(totalPages, currentPage) {
            let paginationContent = "<nav><ul class='pagination justify-content-center'>";
            for (let i = 1; i <= totalPages; i++) {
                paginationContent += `<li class='page-item ${i === currentPage ? "active" : ""}'>
                    <a class='page-link' href='javascript:void(0)' onclick='loadPagedPosts(${i})'>${i}</a>
                </li>`;
            }
            paginationContent += "</ul></nav>";
            $("#pagination").html(paginationContent);
        }
    </script>
}
